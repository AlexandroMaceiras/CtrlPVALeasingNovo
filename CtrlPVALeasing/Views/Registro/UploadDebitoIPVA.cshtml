@model IEnumerable<CtrlPVALeasing.Models.ContratosVeiculosViewModel>
<head>
    <meta name="viewport" content="width=device-width" />

    <!-- Este css dá conflito e faz as janelinhas de filtro do grid ficarem desalinhadas com o símbolo de filtro-->
    <!-- <link href="@Url.Content("~/Content/bootstrap.min.css")" rel="stylesheet" /> -->
    <script src="@Url.Content("~/Scripts/jquery-1.10.2.min.js")"></script>

    <!-- <script src="@Url.Content("~/Scripts/bootstrap.min.js")" type="text/javascript"> </script> -->

</head>
<script>
    function chamaErro4() {
        $(document).ready(function () {
            $("#msgErro4").modal();
        });
    }
    function chamaErro3() {
        $(document).ready(function () {
            $("#msgErro3").modal();
        });
    }
    function chamaErro1() {
        $(document).ready(function () {
            $("#msgErro1").modal();
        });
    }
    function chamaErro7() {
        $(document).ready(function () {
            $("#msgErro7").modal();
        });
    }
    function chamaErro8() {
        $(document).ready(function () {
            $("#msgErro8").modal();
        });
    }
</script>
@{
    ViewBag.Title = "Registro Débito de IPVA";
}

@using (Html.BeginForm("UploadDebitoIPVA", "Registro", FormMethod.Post, new { id = "FormAltera", enctype = "multipart/form-data" }))
{
    var MF = Model.First();
    <div class="jumbotronFundo">
        <input type="hidden" name="rd" id="rd" value="false" />
        <center>
            <table border="0" cellpadding="0" cellspacing="0" width="100%">
                <tr>
                    <th class="busca" width="82%">
                        <h2>UPLOAD DE DÉBITO E PAGAMENTO IPVA</h2>
                    </th>
                    <th class="busca" width="18%" align="right">
                        <br />
                        <a href="~/" class="btn2 btn-primary-pesqui .btn-sm">MENU</a>
                    </th>
                </tr>
            </table>
            <hr />
        </center>
        <center>
            <table width="100%" border="1" cellspacing="0" cellpadding="10" style="border-style:inherit">
                <tr>
                    <td>
                        <b class="fonte-cinza-escuro">REGISTRO DE DÉBITO E PAGAMENTO:</b>
                        <table border="0" style="border-style:inherit">
                            <tr>
                                <td>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;1 - Para subir débitos e pagamentos, baixe <b><a href="~/Modelo de Upload/UploadDebitoDeIPVA.csv">ESTA</a></b> planilha e preencha ela com os dados em cada coluna correta de acordo com o nome do campo que está descrito no topo da coluna e com a sua especificação de tipo. Não apague ou sobrescreva a descrição do topo das colunas, somente preencha com os dados logo abaixo das descrições e especificações de tipo. Existem 2 linhas no topo. A primeira linha indica o formato e o tamanho do dado que pode ser inserido naquela coluna, a segunda linha indica o nome do campo daquela coluna. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 - Existem 4 tipos de especificações de tipo: a) Caracteres - Aceita qualquer tipo de caractere. b) dd/mm/aaaa - Aceita datas inseridas usando-se as barras, ex.: 26/09/2017. c) Numérico - Aceita valores monetários com vírgula de centavos sem ponto de divisão de milhares, ex.: 140585,85. d) 0 ou 1 - 0 para Falso ou 1 para Verdadeiro.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;3 - Pode-se inserir Débitos e Pagamentos de um veículo em cada linha da planilha de acordo com os dados das colunas. Os Débitos podem ser inseridos sem o restante do pagamento, mas o pagamento não pode ser inserido sem os dados do Debito, se um pagamento for inseido sem as colunas de débito preenchidas ele será ignorado. Da coluna A até a P temos os dados do Débito é o restante das colunas é o Pagamento. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4 - Salve a planilha contendos o cabeçalho das descrições do topo e contendo os dados com o mesmo nome (UploadDebitoDeIPVA) e extensão (.csv) que você baixou. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;5 - Clique em [Escolher arquivos] e selecione o UploadDebitoDeIPVA.csv do seu micro e logo após em [Subir]. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    <div class="fonte-cinza-claro fonte-tamanho-form">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6 - Pronto, seus registros já subiram e estão agora na base de dados de débitos. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                </td>
                            </tr>
                            <tr>
                                <td>
                                    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                                </td>
                            </tr>
                        </table>
                        <table border="0" width="10%">
                            <tr>
                                <td>
                                    <input class="input-sm-fino" type="file" name="Upload2" accept=".csv" multiple />
                                </td>
                                <td>
                                    <input onclick="validateForm();" class="btn4 btn-primary-imp .btn-sm" type="submit" name="Submit" id="Submit" value="Subir" />
                                </td>
                            </tr>

                        </table>
                    </td>
                </tr>
            </table>
        </center>
    </div>

    //Erro de veículo não encontrado
    if (MF.id == -1)
    {
        <script>
            try
            {
                $(document).ready(function () {
                    $("#msgErro1").modal();
                });
            }
            catch (e) {
                alert(e);
            }
        </script>
    }
    //Erro de veículo não encontrado
    if (MF.id == -4)
    {
        <script>
            try {
                $(document).ready(function () {
                    $("#msgErro4").modal();
                });
            }
            catch (e) {
                alert(e);
            }
        </script>
    }
    //Erro de veículo não encontrado
    if (MF.id == -3)
    {
        <script>
            try {
                $(document).ready(function () {
                    $("#msgOk").modal();
                });
            }
            catch (e) {
                alert(e);
            }
        </script>
    }
    //Erro de veículo não encontrado
    if (MF.id == -6)
    {
        <script>
            try {
                $(document).ready(function () {
                    $("#msgErro6").modal();
                });
            }
            catch (e) {
                alert(e);
            }
        </script>
    }
}
<script>
    //Limpa os campos mesmo que eles tenham sito recuperados pelo request.
    try {
        $("#mudaReset").click(function () {
            document.getElementById("Upload").setAttribute("value", "");
            document.getElementById("limpaNaMarra2").setAttribute("value", "");
            document.getElementById("limpaNaMarra3").setAttribute("value", "");
            document.getElementById("ConsultaVeiculo").submit();
        });
    }
    catch (e) {
        alert(e);
    }

    try
    {
        function validateForm()
        {
            if (
                document.getElementsByName('Upload')[0].value == ""
                )
            {

                $(document).ready(function () {
                    $("#msgErro5").modal();
                    return false;
                });
                return false;
            }
            else
            {
                document.getElementById("rd").value = true;
                document.getElementById("FormAltera").submit();
                return true;
            }
        }
    }
    catch(e)
    {
        alert(e);
    }
</script>

<div class="modal fade modal-sm" role="dialog" aria-labelledby="example-modal--label" aria-hidden="true" id="msgErro1" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content modal-sm">
            <header class="modal-header modal-sm">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Fecha Janela</span></button>
                <center><h4 class="modal-title modal-sm" id="mySmallModalLabel" style="color:rgb(7, 44, 85)"><b>UPLOAD DÉBITO DE IPVA</b></h4></center>
            </header>
            <div class="modal-body modal-sm">
                <table width="100%">
                    <tr>
                        <td><center><h4 style="color: rgb(206, 39, 39)">Não subiu nenhum registro.</h4><h4 style="color: rgb(206, 39, 39)"> Nenhum registro foi inserido no Banco de Dados por ser um Débito repetido ou não conter nenhum novo Pagamento vinculada à algum Débito existente!</h4></center></td>
                    </tr>
                    <tr>
                        <td align="right"><button type="button" class="btn btn-sm" data-dismiss="modal">Fechar</button></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade modal-sm" role="dialog" aria-labelledby="example-modal--label" aria-hidden="true" id="msgErro4" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content modal-sm">
            <header class="modal-header modal-sm">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Fecha Janela</span></button>
                <center><h4 class="modal-title modal-sm" id="mySmallModalLabel" style="color:rgb(7, 44, 85)"><b>UPLOAD DÉBITO DE IPVA</b></h4></center>
            </header>
            <div class="modal-body modal-sm">
                <table width="100%">
                    <tr>
                        <td><center><h4 style="color: rgb(206, 39, 39)">Erro!</h4><h4 style="color: rgb(206, 39, 39)">Erro na consistência dos dados da planilha!</h4></center></td>
                    </tr>
                    <tr>
                        <td align="right"><button type="button" class="btn btn-sm" data-dismiss="modal">Fechar</button></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade modal-sm" role="dialog" aria-labelledby="example-modal--label" aria-hidden="true" id="msgOk" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content modal-sm">
            <header class="modal-header modal-sm">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Fecha Janela</span></button>
                <center><h4 class="modal-title modal-sm" id="mySmallModalLabel" style="color:rgb(7, 44, 85)"><b>UPLOAD DÉBITO DE IPVA</b></h4></center>
            </header>
            <div class="modal-body modal-sm">
                <table width="100%">
                    <tr>
                        <td><center><h4 style="color: rgb(176, 172, 186)">Registros da planilha incluídos no BD!<h4 style="color: rgb(206, 39, 39)">Sucesso!</h4></center></td>
                    </tr>
                    <tr>
                        <td align="right"><button type="button" class="btn btn-sm" data-dismiss="modal">Fechar</button></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<div class="modal fade modal-sm" role="dialog" aria-labelledby="example-modal--label" aria-hidden="true" id="msgErro6" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content modal-sm">
            <header class="modal-header modal-sm">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">×</span><span class="sr-only">Fecha Janela</span></button>
                <center><h4 class="modal-title modal-sm" id="mySmallModalLabel" style="color:rgb(7, 44, 85)"><b>UPLOAD DÉBITO DE IPVA</b></h4></center>
            </header>
            <div class="modal-body modal-sm">
                <table width="100%">
                    <tr>
                        <td><center><h4 style="color: rgb(206, 39, 39)">Erro!</h4><h4 style="color: rgb(176, 172, 186)">Erro de entrada de dados!</center></td>
                    </tr>
                    <tr>
                        <td align="right"><button type="button" class="btn btn-sm" data-dismiss="modal">Fechar</button></td>
                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>
